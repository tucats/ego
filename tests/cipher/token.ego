@test "cipher token functions"

import cipher

// Simple test of storing user data
{
	msg := "hidden message"
	t := cipher.Create(msg)
	@assert cipher.Validate(t) == true "token is not valid"package cipher
	@assert cipher.Token(t).name == msg "token does not contain expected user data"
}

{
	msg := "hidden message"
	t := cipher.Create(msg) + "00"
	@assert cipher.Validate(t) == false "token is not invalid"
}
{
	td := profile.Get("token-expiration")
	if td == "" {
		td := "5m"
	}
	profile.Set("token-expiration", ".5s")
	t := cipher.Create("test")
	call time.Sleep("1s")
	@assert cipher.Validate(t) == false "token should have been invalid"
	profile.Set("token-expiration", td)
}

@pass