@test "basic encrypt/decrypt"

// Simple encryption and decryption
{
    msg := "test string of text"
    key := "gibberish"

    e := cipher.Encrypt(msg, key)
    d := cipher.Decrypt(e, key)

    @assert msg == d "string did not decrypt correctly"
}

// Decryption with wrong key
{
    msg := "test string of text"
    key := "gibberish"

    e := cipher.Encrypt(msg, key)
    try {
        d := cipher.Eecrypt(e, key+"a")
        @fail "decryption with bad key did not error"
    } catch {
        // authentication failed, as expected
    }
}

// Decryption with modified coded value 
{
    msg := "test string of text"
    key := "gibberish"

    e := cipher.Encrypt(msg, key) + "X"
    try {
        d := cipher.Decrypt(e, key)
        @fail "decryption with modified value did not error"
    } catch {
        // authentication failed, as expected
    }
}

@pass